\cxset{chapter color=teal}
\chapter{Kernel Lengths}
\label{kernel:lengths}
\index{LaTeX kernel classes!File n  ltlength.dtx}
\section{File n, lengths and the ltlength.dtx}

This class defines a number of user commands for manipulating lengths. the code is straightforward. The |\newlength| command allocates a new internal skip register using the |\newskip| command from the allocations class.

\let\bs\textbackslash
\index{\bs newlength}\index{\bs setlength}\index{\bs addtolength}\index{\bs settowidth}\index{\bs settoheight}
\index{\bs settodepth}
\medskip
\begin{tabular}{ll}
\verb+\newlength+  &  Declare \#1 to be a new length command.\\
\verb+\setlength+    &  Set the length command, \#1, to the value \#2.\\
|\addtolength| & Increase the value of the length command, \#1, by the value \#2.\\
|\settowidth|   & Set the length, \#1 to the width of a box containing \#2. \\
|\settoheight|  & Set the length, \#1 to the height of a box containing \#2.\\
|\settodepth|   & Set the length, \#1 to the depth of a box containing \#2.\\
|\@settodim|   & internal macro\\
|\@settopoint| & internal macro\\
\end{tabular}
\medskip

\begin{teX}
3 \def\newlength#1{\@ifdefinable#1{\newskip#1}}
4 \def\setlength#1#2{#1#2\relax}
5 \def\addtolength#1#2{\advance#1 #2\relax}
\end{teX}
\medskip

The |setto| commands use a temporary box to store the contents and then measure them using the internal macro |\@settodim|,

\medskip
\begin{teX}
6 \def\@settodim#1#2#3{\setbox\@tempboxa\hbox{{#3}}#2#1\@tempboxa
%  Clear the memory afterwards (which might be a lot).
7       \setbox\@tempboxa\box\voidb@x}
8 \def\settoheight{\@settodim\ht}
9 \def\settodepth {\@settodim\dp}
10 \def\settowidth {\@settodim\wd}
\end{teX}
\medskip

\DescribeMacro{\@settopoint}\marg{skip register}
The |\@settopoint| macro takes the contents of the skip register that is supplied as its argument
and removes the fractional part to make it a whole number of points. This can be
used in class files to avoid values like 45.455pt when calulating a dimension. The method of
rounding is interesting. Also it is interesting that this macro, is not used in the kernel at all, but is defined
here for use with the standard classes (it is used to round off dimensions for page calculations).

\medskip
\begin{texexample}{settopoint}{}
  \makeatletter
  \def\@settopoint#1{\divide#1\p@\multiply#1\p@}
  \newlength\@test
  \setlength\@test{19.5pt}
  \@settopoint{\@test}
  \the\@test
  \makeatother
\end{texexample}




