\title{Farbige Mathematik}
\author{Herbert Voß}
\maketitle
\begin{abstract}
Die Zahl der Veröffentlichungen, die als PDF allgemein zur Verfügung gestellt
werden, nimmt stetig zu. Da diese sehr häufig mit dem Acrobat Reader
online betrachtet und gelesen werden, spielt die farbliche Darstellung
eine nicht unbedeutende Rolle. Im folgenden soll daher gezeigt werden, wie man
insbesondere für den Mathematikmodus farbige Darstellungen erreichen kann.
\end{abstract}

\section{Das Prinzip}
Grundsätzlich wird nichts weiter als das allgemein bekannte Paket \verb+color+
benötigt. \cite{color} Dieses stellt die vordefinierten Farben \textcolor{black}{black},
\textcolor{red}{red}, \textcolor{green}{green}, \textcolor{blue}{blue},
\textcolor{cyan}{cyan}, \textcolor{magenta}{magenta}, \textcolor{yellow}{yellow}
und natürlich \colorbox[gray]{0.75}{\textcolor{white}{white}}
bereit. Weitere lassen sich über den \verb+\definecolor+ Befehl neu definieren.

\section{Partielles Einfärben}
Für das Färben einzelner Wörter existiert das Makro \verb+\textcolor+., welches ebenfalls
für das Einfärben einzelner Teile einer mathematischen Formel benutz werden kann.
\begin{align}\label{eq:1}
\int_1^2 \textcolor{red}{\frac{1}{x^2}}\,dx &= 0.5
\end{align}

\begin{lstlisting}
\begin{align}
\int_1^2 \textcolor{red}{\frac{1}{x^2}}\,dx &= 0.5
\end{align}
\end{lstlisting}
Das entsprechende Makro mit der Syntax \verb+\textcolor{<Farbe>}{<Text>}+ ist zwar
vom Namen her missverständlich,
lässt sich jedoch im Mathematikmodus in der gleichen Weise anwenden, ohne dass dieser
Modus verlassen werden muss. Gleichung~\ref{eq:1} zeigt, dass die Variable $x$
kursiv gedruckt wird, was für den mathematischen Modus Standard ist.

\begin{align}\label{eq:pqFormel}
y &= 2x^2 -3x +5\\\nonumber
  & \hphantom{= \ 2\left(x^2-\frac{3}{2}\,x\right. }%
         \textcolor{blue}{%
              \overbrace{\hphantom{+\left(\frac{3}{4}\right)^2- %
                  \left(\frac{3}{4}\right)^2}}^{=0}}\\[-11pt]
  &= 2\left(\textcolor{red}{%
     \underbrace{%
         x^2-\frac{3}{2}\,x + \left(\frac{3}{4}\right)^2}%
     }%
     \underbrace{%
        - \left(\frac{3}{4}\right)^2 + \frac{5}{2}}%
     \right)\\
  &= 2\left(\qquad\textcolor{red}{\left(x-\frac{3}{4}\right)^2}
     \qquad + \ \frac{31}{16}\qquad\right)\\
y\textcolor{blue}{-\frac{31}{8}}
  &= 2\left(x\textcolor{cyan}{-\frac{3}{4}}\right)^2%
\end{align}

\medskip
\begin{lstlisting}
\begin{align}\label{eq:pqFormel}
y &= 2x^2 -3x +5\\\nonumber
  & \hphantom{= \ 2\left(x^2-\frac{3}{2}\,x\right. }%
         \textcolor{blue}{%
              \overbrace{\hphantom{+\left(\frac{3}{4}\right)^2- %
                  \left(\frac{3}{4}\right)^2}}^{=0}}\\[-11pt]
  &= 2\left(\textcolor{red}{%
     \underbrace{%
         x^2-\frac{3}{2}\,x + \left(\frac{3}{4}\right)^2}%
     }%
     \underbrace{%
        - \left(\frac{3}{4}\right)^2 + \frac{5}{2}}%
     \right)\\
  &= 2\left(\qquad\textcolor{red}{\left(x-\frac{3}{4}\right)^2}
     \qquad + \ \frac{31}{16}\qquad\right)\\
y\textcolor{blue}{-\frac{31}{8}}
  &= 2\left(x\textcolor{cyan}{-\frac{3}{4}}\right)^2%
\end{align}
\end{lstlisting}

Es ist offensichtlich, dass selbst für triviale mathematische Zusammenhänge, wie sie durch
Gleichung~\ref{eq:pqFormel} gegeben sind, mit der Farbe eine übersichtlichere Darstellung
möglich ist.


\section{Komplettes Einfärben}
Im sogenannten
Inlinemodus können auf einfache Weise ganze mathematische Ausdrücke in Farbe
gesetzt werden, beispielsweise bezieht sich \textcolor{blue}{$y=x^2+px+q$} auf die
Gleichung~\ref{eq:pqFormel}. Hierbei spielt es keine Rolle, ob der mathematische
Teil komplett als Argument erscheint \verb|\textcolor{blue}{$y=x^2+px+q$}| oder
umgekehrt das \verb+\textcolor+ Makro innerhalb der Formel, wie bei diesem Ausdruck
$\textcolor{magenta}{c^2=a^2+b^2}$ (\verb|$\textcolor{magenta}{c^2=a^2+b^2}$|).

Im Gegensatz zum \verb+\textcolor+ Makro erwarten \verb+\colorbox+ und
\verb+\fcolorbox+ den Parameter im
Textmodus, sodass in diesem Fall der mathematische Modus erneut aktiviert werden muss,
wenn diese Makros innerhalb einer mathematischen Umgebung angewendet werden (Gl.~\ref{eq:6}).
\bgroup
\def\xstrut{\vphantom{\dfrac{(A)^1}{(B)^1}}}
\begin{equation}\label{eq:6}
E = %
	\colorbox{darkyellow}{$\xstrut a_vA$} -
	\colorbox{hellmagenta}{$\xstrut a_fA^{2/3}$} -
	\colorbox{green}{$\xstrut a_c\dfrac{Z(Z-1)}{A^{1/3}}$} -
	\colorbox{cyan}{$\xstrut a_s\dfrac{(A-2Z)^2}{A}$} +
	\colorbox{yellow}{$\xstrut E_p$}
\end{equation}
\egroup

\medskip
\begin{lstlisting}
\def\xstrut{\vphantom{\frac{(A)^1}{(B)^1}}}
\begin{equation}\label{eq:6}
E = %
	\colorbox{darkyellow}{$\xstrut a_vA$} +
	\colorbox{hellmagenta}{$\xstrut -a_fA^{2/3}$} +
	\colorbox{green}{$\xstrut -a_c\frac{Z(Z-1)}{A^{1/3}}$} +
	\colorbox{cyan}{$\xstrut -a_s\frac{(A-2Z)^2}{A}$} +
	\colorbox{yellow}{$\xstrut E_p$}
\end{equation}
\end{lstlisting}

Abgesetzte Formeln können ebenso komplett eingefärbt werden, wobei gleichzeitig
für Gleichung~\ref{eq:cd}
noch eine partielle Rotfärbung vorgenommen wurde. Die globale Umschaltung auf eine
andere Farbe geschieht mit dem \verb+color{<Farbe>}+ Befehl, der einfach an den
Beginn der abgesetzten Gleichung gesetzt wird.

\[\label{eq:5}\color{magenta}
\left(\prod^n_{\, j=1}\hat{x}_j\right)H_c=%
    \frac{1}{2}\hat{k}_{ij}\det\widehat{\mathbf{K}}(i|i)
\]

\begin{align}\label{eq:cd}\color{blue}
\begin{CD}
  R\times S\times T @>\text{restriction}>> S\times T \\
        @VprojVV                            @VVprojV \\
  R\times S         @<<\text{\textcolor{red}{inclusion}}<   S
\end{CD}
\end{align}

\medskip
\begin{lstlisting}
\[\color{magenta}
\left(\prod^n_{\, j=1}\hat{x}_j\right)H_c=%
    \frac{1}{2}\hat{k}_{ij}\det\widehat{\mathbf{K}}(i|i)
\]

\begin{align}\label{eq:cd}\color{blue}
\begin{CD}
  R\times S\times T @>\text{restriction}>> S\times T \\
        @VprojVV                            @VVprojV \\
  R\times S         @<<\text{\textcolor{red}{inclusion}}< S
\end{CD}
\end{align}
\end{lstlisting}

\section{Farbboxen}
Hier sind aus dem Textmodus die Makros \verb+colorbox+ und \verb+fcolorbox+ bekannt,
die sich ebenfalls auf den mathematischen Modus übertragen lassen:
\colorbox{yellow}{$x_{n+1}\leftarrow x_n^2+c$} in der komplexen Zahlenmenge betrachtet,
hat etwas mit Benoit Mandelbrot zu tun.

\begin{lstlisting}
\colorbox{yellow}{$x_{n+1}\leftarrow x_n^2+c$} in der komplexen Zahlenmenge betrachtet,
hat etwas mit Benoit Mandelbrot zu tun.
\end{lstlisting}

Ebenso hätte man auch bei dieser im Inlinemodus geschriebenen Formel \verb+\fcolorbox+
verwenden können, welches das Gegenstück zu \verb+\fbox+ darstellt:
\fcolorbox{red}{yellow}{$x_{n+1}\leftarrow x_n^2+c$}. Für den Rahmen ist
dann eine zusätzliche Farbe als Parameter zu übergeben \verb+\fcolorbox{red}{yellow}{$...$}+.

Etwas schwieriger ist der Fall, wenn man abgesetzte Formeln einfärben will, die
gleichzeitig eine Gleichungsnummer aufweisen, denn diese könnte sowohl innerhalb
als auch außerhalb der farbigen Box erscheinen. Weiterhin
muss die abgesetzte Formel zusätzlich in eine \verb+parbox+ gepackt werden, um dann
beispielweise so etwas wie Gleichung~\ref{eq:3} zu erhalten.

\colorbox{hellmagenta}{%
\parbox{\linewidth-2\fboxsep}{%
	\begin{align}\label{eq:3}
		\frac{I(\alpha )}{I_{0}}=%
			\begin{cases}
				\sqrt{1-\frac{\alpha}{\pi}+\frac{1}{2\pi}\sin 2\alpha}
					& \varphi =0\\[0.4cm]
				\sqrt{2\left(1-\frac{\alpha}{\pi}\right)%
					\left(2+\cos 2\alpha \right)+\frac{3}{\pi}\sin 2\alpha}
					& \varphi =\frac{\pi}{2}
			\end{cases}
	\end{align}%
}}

\medskip
\begin{lstlisting}
\colorbox{hellmagenta}{%
\parbox{\linewidth-2\fboxsep}{%
    \begin{align}\label{eq:3}
	\frac{I(\alpha )}{I_{0}}=%
    	    \begin{cases}
		\sqrt{1-\frac{\alpha}{\pi}+\frac{1}{2\pi}\sin 2\alpha}
			& \varphi =0\\[0.4cm]
		\sqrt{2\left(1-\frac{\alpha}{\pi}\right)\left(2+%
			\cos 2\alpha \right)+\frac{3}{\pi}\sin 2\alpha}
			& \varphi =\frac{\pi}{2}
	    \end{cases}
    \end{align}%
}}
\end{lstlisting}

Wenn man dagegen keine Gleichungsnummer hat und die Formel nur
für den Bereich einfärben will, den sie auch tatsächlich benötigt, hat man das
Problem, dass man schon bei der Definition der \verb+parbox+ ihre Breite kennen muss,
was zu diesem Zeitpunkt jedoch noch nicht bekannt ist. Hierbei kann man sich mit dem Paket
\verb+empheq+ \cite{empheq} helfen, welches die Aufgabe der Boxbreitenbestimmung vornimmt,
wobei dieses Paket dies auch unabhängig davon kann, ob eine Gleichungsnummer erscheint
oder nicht.

\begin{empheq}[box=\fcolorbox{blue}{hellcyan}]{align*}
	x(t) & =\frac{a\left(t^{2}-1\right)}{t^2+1}\\
	y(t) & =\frac{at\left(t^{2}-1\right)}{t^2+1}
\end{empheq}


\medskip
\begin{lstlisting}
\begin{empheq}[box=\fcolorbox{blue}{hellcyan}]{align*}
	x(t) & =\frac{a\left(t^{2}-1\right)}{\t^2+1}\\
	y(t) & =\frac{at\left(t^{2}-1\right)}{t^2+1}
\end{empheq}
\end{lstlisting}


Für komplett farbig hinterlegte Gleichungen kann noch das Paket \verb+framed+ benutzt werden.\cite{framed} Es definiert die Umgebung \verb+shaded+, welche die mathematischen
Umgebungen einfach umschließen kann. \verb+framed+ hat den Vorteil, dass es auch ohne
weiteres über Seitenumbrüche hinweg funktioniert und zu dem mehrere, auch verschiedene,
mathematische Umgebungen umfassen kann.

\begin{shaded}
\begin{align}
\underset{\mathcal{G}\quad}\iiint\!%
	\left[u\nabla^{2}v+\left(\nabla u,\nabla v\right)\right]d^{3}V%
	=\underset{\mathcal{S}\quad}\oiint u\Q{v}{n}d^{2}A
\end{align}
\begin{align}
\underset{{\mathcal{G}\quad}}\iiint\!%
	\left[u\nabla^{2}v-v\nabla^{2}u\right]d^{3}V%
	=\underset{\mathcal{S}\quad}\oiint%
	\left(u\Q{v}{n}-v\Q{u}{n}\right)d^{2}A
\end{align}
\end{shaded}

\medskip
\begin{lstlisting}
\begin{shaded}
\begin{align}
\underset{\mathcal{G}\quad}\iiint\!%
	\left[u\nabla^{2}v+\left(\nabla u,\nabla v\right)\right]d^{3}V%
	=\underset{\mathcal{S}\quad}\oiint u\Q{v}{n}d^{2}A
\]
\[
\underset{{\mathcal{G}\quad}}\iiint\!%
	\left[u\nabla^{2}v-v\nabla^{2}u\right]d^{3}V%
	=\underset{\mathcal{S}\quad}\oiint%
	\left(u\Q{v}{n}-v\Q{u}{n}\right)d^{2}A
\]
\end{shaded}
\end{lstlisting}


\section{Zusammenfassung}
Es wurde gezeigt, dass ebenfalls für den mathematischen Modus das Einfärben von Formeln
oder Teilen davon mit den bestehenden Makros ohne weiteres möglich ist. Andere
oder weitergehende Möglichkeiten kann man \cite{voss-Math} entnehmen.

\begingroup
  \renewcommand\refname{Literatur und Software}
  \renewcommand\bibname{\refname}
  \bibliography{mathCol}
\endgroup

\address{Herbert}{Voß}{Wasgenstr. 21\\14129 Berlin\\voss@perce.de}
